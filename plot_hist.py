import matplotlib.pyplot as plt
from tqdm import tqdm
import seaborn as sns
import numpy as np
import argparse
import os
from matplotlib.ticker import FixedFormatter


def create_directory(directory_path):
    if not os.path.exists(directory_path):
        os.makedirs(directory_path)

parser = argparse.ArgumentParser(prog='Visualize L2P', description='Visualize L2P keys and prompts')
parser.add_argument('--model', default="5_datasets_task_wise", type=str)

args = parser.parse_args()

if args.model == "no_batchwise":
    task_key_counts = {0: {0: 370, 1: 624, 2: 347, 3: 652, 4: 372, 5: 679, 6: 632, 7: 321, 8: 225, 9: 778}, 1: {0: 543, 1: 457, 2: 545, 3: 458, 4: 539, 5: 459, 6: 456, 7: 543, 8: 530, 9: 470}, 2: {0: 343, 1: 651, 2: 331, 3: 669, 4: 349, 5: 679, 6: 657, 7: 321, 8: 216, 9: 784}, 3: {0: 598, 1: 406, 2: 610, 3: 390, 4: 593, 5: 396, 6: 402, 7: 605, 8: 420, 9: 580}, 4: {0: 573, 1: 423, 2: 581, 3: 419, 4: 575, 5: 427, 6: 427, 7: 574, 8: 447, 9: 554}, 5: {0: 544, 1: 451, 2: 550, 3: 452, 4: 545, 5: 454, 6: 457, 7: 546, 8: 470, 9: 531}, 6: {0: 567, 1: 429, 2: 568, 3: 431, 4: 570, 5: 445, 6: 433, 7: 557, 8: 365, 9: 635}, 7: {0: 551, 1: 443, 2: 543, 3: 456, 4: 556, 5: 463, 6: 447, 7: 541, 8: 284, 9: 716}, 8: {0: 465, 1: 536, 2: 471, 3: 529, 4: 462, 5: 529, 6: 535, 7: 471, 8: 405, 9: 597}, 9: {0: 532, 1: 465, 2: 506, 3: 493, 4: 535, 5: 531, 6: 468, 7: 470, 8: 236, 9: 764}}
elif args.model == "no_batchwise_training":
    task_key_counts = {0: {0: 22412, 1: 24815, 2: 19998, 3: 12102, 4: 7737, 5: 7897, 6: 7115, 7: 7163, 8: 6299, 9: 7168}, 1: {0: 1577, 1: 208, 2: 5200, 3: 12775, 4: 17024, 5: 16965, 6: 17861, 7: 17752, 8: 18698, 9: 17485}, 2: {0: 3518, 1: 6779, 2: 5327, 3: 9830, 4: 7541, 5: 7967, 6: 7212, 7: 7116, 8: 6338, 9: 6646}, 3: {0: 21486, 1: 20777, 2: 18903, 3: 14840, 4: 17372, 5: 17103, 6: 18038, 7: 18004, 8: 18675, 9: 18354}, 4: {0: 16124, 1: 10227, 2: 6432, 3: 10102, 4: 7685, 5: 7874, 6: 7043, 7: 7174, 8: 6329, 9: 7496}, 5: {0: 23402, 1: 24357, 2: 21714, 3: 15057, 4: 17322, 5: 16935, 6: 17805, 7: 17989, 8: 18676, 9: 18716}, 6: {0: 9472, 1: 12148, 2: 17669, 3: 14460, 4: 17318, 5: 17115, 6: 17934, 7: 17802, 8: 18664, 9: 17820}, 7: {0: 752, 1: 676, 2: 4577, 3: 10334, 4: 7679, 5: 7891, 6: 6959, 7: 7005, 8: 6309, 9: 6296}, 8: {0: 24269, 1: 24959, 2: 24373, 3: 23260, 4: 19009, 5: 14409, 6: 6643, 7: 6241, 8: 4545, 9: 3377}, 9: {0: 1988, 1: 54, 2: 807, 3: 2240, 4: 6313, 5: 10844, 6: 18390, 7: 18754, 8: 20467, 9: 21642}}
elif args.model == "task_wise":
    task_key_counts = {0: {0: 538, 1: 542, 2: 538, 3: 537, 4: 545, 5: 35, 6: 35, 7: 31, 8: 35, 9: 32, 10: 51, 11: 51, 12: 51, 13: 51, 14: 51, 15: 156, 16: 153, 17: 159, 18: 153, 19: 158, 20: 26, 21: 26, 22: 30, 23: 26, 24: 28, 25: 20, 26: 20, 27: 21, 28: 21, 29: 21, 30: 9, 31: 9, 32: 9, 33: 9, 34: 9, 35: 94, 36: 94, 37: 93, 38: 94, 39: 94, 40: 56, 41: 53, 42: 61, 43: 55, 44: 59, 45: 12, 46: 13, 47: 12, 48: 12, 49: 12}, 1: {0: 70, 1: 74, 2: 76, 3: 77, 4: 76, 5: 430, 6: 434, 7: 428, 8: 432, 9: 429, 10: 44, 11: 44, 12: 45, 13: 44, 14: 44, 15: 167, 16: 166, 17: 168, 18: 167, 19: 168, 20: 31, 21: 32, 22: 32, 23: 31, 24: 31, 25: 51, 26: 51, 27: 50, 28: 51, 29: 50, 30: 27, 31: 27, 32: 27, 33: 27, 34: 27, 35: 84, 36: 84, 37: 85, 38: 84, 39: 84, 40: 79, 41: 78, 42: 80, 43: 79, 44: 79, 45: 11, 46: 12, 47: 11, 48: 11, 49: 11}, 2: {0: 28, 1: 26, 2: 29, 3: 28, 4: 28, 5: 10, 6: 9, 7: 10, 8: 10, 9: 10, 10: 526, 11: 526, 12: 527, 13: 526, 14: 527, 15: 95, 16: 93, 17: 96, 18: 95, 19: 95, 20: 32, 21: 31, 22: 33, 23: 32, 24: 32, 25: 21, 26: 20, 27: 21, 28: 21, 29: 21, 30: 33, 31: 32, 32: 33, 33: 32, 34: 33, 35: 162, 36: 162, 37: 162, 38: 162, 39: 162, 40: 91, 41: 90, 42: 92, 43: 90, 44: 91, 45: 3, 46: 3, 47: 3, 48: 3, 49: 3}, 3: {0: 19, 1: 19, 2: 19, 3: 19, 4: 20, 5: 64, 6: 66, 7: 64, 8: 65, 9: 64, 10: 10, 11: 10, 12: 10, 13: 10, 14: 10, 15: 631, 16: 629, 17: 635, 18: 629, 19: 634, 20: 25, 21: 24, 22: 25, 23: 24, 24: 25, 25: 36, 26: 36, 27: 36, 28: 36, 29: 36, 30: 13, 31: 13, 32: 13, 33: 13, 34: 13, 35: 133, 36: 134, 37: 132, 38: 133, 39: 132, 40: 40, 41: 40, 42: 40, 43: 40, 44: 40, 45: 28, 46: 28, 47: 28, 48: 29, 49: 28}, 4: {0: 34, 1: 35, 2: 36, 3: 35, 4: 35, 5: 48, 6: 49, 7: 47, 8: 48, 9: 48, 10: 85, 11: 85, 12: 85, 13: 85, 14: 85, 15: 174, 16: 174, 17: 176, 18: 175, 19: 174, 20: 357, 21: 357, 22: 356, 23: 357, 24: 355, 25: 70, 26: 71, 27: 71, 28: 70, 29: 70, 30: 8, 31: 8, 32: 7, 33: 8, 34: 8, 35: 124, 36: 124, 37: 124, 38: 124, 39: 124, 40: 82, 41: 82, 42: 82, 43: 82, 44: 82, 45: 17, 46: 17, 47: 16, 48: 17, 49: 17}, 5: {0: 24, 1: 22, 2: 25, 3: 22, 4: 22, 5: 56, 6: 56, 7: 56, 8: 56, 9: 56, 10: 4, 11: 4, 12: 5, 13: 4, 14: 5, 15: 185, 16: 185, 17: 185, 18: 185, 19: 185, 20: 9, 21: 9, 22: 9, 23: 9, 24: 9, 25: 573, 26: 573, 27: 572, 28: 573, 29: 572, 30: 12, 31: 12, 32: 12, 33: 12, 34: 12, 35: 100, 36: 100, 37: 100, 38: 100, 39: 100, 40: 35, 41: 35, 42: 35, 43: 35, 44: 35, 45: 3, 46: 3, 47: 3, 48: 3, 49: 3}, 6: {0: 29, 1: 31, 2: 33, 3: 33, 4: 33, 5: 29, 6: 29, 7: 29, 8: 29, 9: 29, 10: 34, 11: 33, 12: 34, 13: 33, 14: 34, 15: 218, 16: 217, 17: 220, 18: 217, 19: 217, 20: 20, 21: 20, 22: 21, 23: 20, 24: 20, 25: 38, 26: 39, 27: 38, 28: 38, 29: 38, 30: 406, 31: 406, 32: 403, 33: 407, 34: 406, 35: 178, 36: 178, 37: 178, 38: 178, 39: 178, 40: 33, 41: 32, 42: 34, 43: 33, 44: 33, 45: 13, 46: 12, 47: 13, 48: 13, 49: 13}, 7: {0: 34, 1: 32, 2: 34, 3: 35, 4: 37, 5: 38, 6: 38, 7: 38, 8: 38, 9: 38, 10: 30, 11: 28, 12: 30, 13: 28, 14: 30, 15: 92, 16: 91, 17: 92, 18: 91, 19: 92, 20: 13, 21: 13, 22: 13, 23: 13, 24: 13, 25: 47, 26: 47, 27: 47, 28: 47, 29: 47, 30: 34, 31: 35, 32: 34, 33: 35, 34: 34, 35: 666, 36: 667, 37: 664, 38: 666, 39: 664, 40: 27, 41: 28, 42: 27, 43: 28, 44: 27, 45: 20, 46: 20, 47: 19, 48: 20, 49: 19}, 8: {0: 52, 1: 49, 2: 53, 3: 52, 4: 52, 5: 93, 6: 93, 7: 93, 8: 93, 9: 93, 10: 32, 11: 32, 12: 32, 13: 32, 14: 32, 15: 137, 16: 136, 17: 137, 18: 137, 19: 137, 20: 66, 21: 65, 22: 66, 23: 66, 24: 66, 25: 58, 26: 59, 27: 61, 28: 58, 29: 60, 30: 8, 31: 8, 32: 8, 33: 8, 34: 8, 35: 37, 36: 36, 37: 38, 38: 36, 39: 38, 40: 510, 41: 509, 42: 513, 43: 510, 44: 511, 45: 6, 46: 6, 47: 6, 48: 6, 49: 6}, 9: {0: 38, 1: 40, 2: 45, 3: 42, 4: 42, 5: 57, 6: 57, 7: 58, 8: 57, 9: 58, 10: 18, 11: 17, 12: 20, 13: 18, 14: 18, 15: 175, 16: 175, 17: 177, 18: 175, 19: 176, 20: 30, 21: 29, 22: 30, 23: 29, 24: 30, 25: 67, 26: 68, 27: 68, 28: 67, 29: 67, 30: 21, 31: 20, 32: 21, 33: 20, 34: 21, 35: 170, 36: 172, 37: 169, 38: 172, 39: 170, 40: 104, 41: 104, 42: 106, 43: 104, 44: 106, 45: 314, 46: 315, 47: 315, 48: 314, 49: 314}}
elif args.model == "penalty":
    task_key_counts = {0: {0: 984, 1: 0, 2: 22, 3: 997, 4: 4, 5: 1000, 6: 34, 7: 964, 8: 991, 9: 4}, 1: {0: 996, 1: 0, 2: 2, 3: 1000, 4: 4, 5: 1000, 6: 4, 7: 995, 8: 999, 9: 0}, 2: {0: 993, 1: 1, 2: 3, 3: 998, 4: 5, 5: 999, 6: 6, 7: 994, 8: 1000, 9: 1}, 3: {0: 976, 1: 6, 2: 3, 3: 994, 4: 27, 5: 1000, 6: 2, 7: 993, 8: 999, 9: 0}, 4: {0: 995, 1: 1, 2: 6, 3: 1000, 4: 1, 5: 1000, 6: 3, 7: 996, 8: 998, 9: 0}, 5: {0: 990, 1: 1, 2: 2, 3: 999, 4: 6, 5: 1000, 6: 10, 7: 990, 8: 1000, 9: 2}, 6: {0: 997, 1: 0, 2: 0, 3: 1000, 4: 1, 5: 1000, 6: 3, 7: 999, 8: 1000, 9: 0}, 7: {0: 995, 1: 1, 2: 1, 3: 999, 4: 0, 5: 1000, 6: 3, 7: 1000, 8: 1000, 9: 1}, 8: {0: 991, 1: 3, 2: 6, 3: 999, 4: 0, 5: 1000, 6: 4, 7: 996, 8: 1000, 9: 1}, 9: {0: 998, 1: 0, 2: 0, 3: 1000, 4: 0, 5: 1000, 6: 3, 7: 999, 8: 1000, 9: 0}}
elif args.model == "5_datasets_l2p":
    task_key_counts = {0: {0: 0, 1: 26032, 2: 0, 3: 0, 4: 0, 5: 0, 6: 26032, 7: 0, 8: 26032, 9: 0, 10: 0, 11: 0, 12: 26032, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0}, 1: {0: 0, 1: 10000, 2: 0, 3: 0, 4: 0, 5: 0, 6: 10000, 7: 0, 8: 10000, 9: 0, 10: 0, 11: 0, 12: 10000, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0}, 2: {0: 0, 1: 10000, 2: 0, 3: 0, 4: 0, 5: 0, 6: 10000, 7: 0, 8: 10000, 9: 0, 10: 0, 11: 0, 12: 10000, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0}, 3: {0: 0, 1: 459, 2: 0, 3: 0, 4: 0, 5: 0, 6: 459, 7: 0, 8: 459, 9: 0, 10: 0, 11: 0, 12: 459, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0}, 4: {0: 0, 1: 10000, 2: 0, 3: 0, 4: 0, 5: 0, 6: 10000, 7: 0, 8: 10000, 9: 0, 10: 0, 11: 0, 12: 10000, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0}}
elif args.model == "5_datasets_l2p_training":
    task_key_counts = {0: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 1: {0: 366237, 1: 300000, 2: 250000, 3: 91325, 4: 300000}, 2: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 3: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 4: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 5: {0: 32, 1: 0, 2: 0, 3: 0, 4: 0}, 6: {0: 366253, 1: 300000, 2: 250000, 3: 91325, 4: 300000}, 7: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 8: {0: 366269, 1: 300000, 2: 250000, 3: 91325, 4: 300000}, 9: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 10: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 11: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 12: {0: 366205, 1: 300000, 2: 250000, 3: 91325, 4: 300000}, 13: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 14: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 15: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 16: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 17: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 18: {0: 16, 1: 0, 2: 0, 3: 0, 4: 0}, 19: {0: 128, 1: 0, 2: 0, 3: 0, 4: 0}}
elif args.model == "5_datasets_task_wise":
    task_key_counts = {0: {0: 25874, 1: 25874, 2: 25873, 3: 25873, 4: 10, 5: 10, 6: 10, 7: 10, 8: 84, 9: 84, 10: 83, 11: 83, 12: 28, 13: 28, 14: 28, 15: 28, 16: 37, 17: 37, 18: 37, 19: 37}, 1: {0: 0, 1: 0, 2: 0, 3: 0, 4: 9990, 5: 9990, 6: 9990, 7: 9990, 8: 0, 9: 0, 10: 0, 11: 0, 12: 10, 13: 10, 14: 10, 15: 10, 16: 0, 17: 0, 18: 0, 19: 0}, 2: {0: 1464, 1: 1464, 2: 1465, 3: 1465, 4: 41, 5: 41, 6: 41, 7: 41, 8: 8377, 9: 8376, 10: 8377, 11: 8377, 12: 42, 13: 42, 14: 41, 15: 41, 16: 76, 17: 76, 18: 77, 19: 76}, 3: {0: 2, 1: 2, 2: 2, 3: 2, 4: 202, 5: 202, 6: 202, 7: 202, 8: 0, 9: 0, 10: 0, 11: 0, 12: 254, 13: 254, 14: 254, 15: 254, 16: 1, 17: 1, 18: 1, 19: 1}, 4: {0: 1, 1: 1, 2: 1, 3: 1, 4: 805, 5: 805, 6: 805, 7: 805, 8: 0, 9: 0, 10: 0, 11: 0, 12: 67, 13: 67, 14: 67, 15: 67, 16: 9127, 17: 9127, 18: 9127, 19: 9127}}
elif args.model == "5_datasets_task_wise_training":
    task_key_counts = {0: {0: 366285, 1: 0, 2: 0, 3: 0, 4: 0}, 1: {0: 366285, 1: 0, 2: 0, 3: 0, 4: 0}, 2: {0: 366285, 1: 0, 2: 0, 3: 0, 4: 0}, 3: {0: 366285, 1: 0, 2: 0, 3: 0, 4: 0}, 4: {0: 0, 1: 300000, 2: 0, 3: 0, 4: 0}, 5: {0: 0, 1: 300000, 2: 0, 3: 0, 4: 0}, 6: {0: 0, 1: 300000, 2: 0, 3: 0, 4: 0}, 7: {0: 0, 1: 300000, 2: 0, 3: 0, 4: 0}, 8: {0: 0, 1: 0, 2: 250000, 3: 0, 4: 0}, 9: {0: 0, 1: 0, 2: 250000, 3: 0, 4: 0}, 10: {0: 0, 1: 0, 2: 250000, 3: 0, 4: 0}, 11: {0: 0, 1: 0, 2: 250000, 3: 0, 4: 0}, 12: {0: 0, 1: 0, 2: 0, 3: 91325, 4: 0}, 13: {0: 0, 1: 0, 2: 0, 3: 91325, 4: 0}, 14: {0: 0, 1: 0, 2: 0, 3: 91325, 4: 0}, 15: {0: 0, 1: 0, 2: 0, 3: 91325, 4: 0}, 16: {0: 0, 1: 0, 2: 0, 3: 0, 4: 300000}, 17: {0: 0, 1: 0, 2: 0, 3: 0, 4: 300000}, 18: {0: 0, 1: 0, 2: 0, 3: 0, 4: 300000}, 19: {0: 0, 1: 0, 2: 0, 3: 0, 4: 300000}}
elif args.model == "5_datasets_task_inc_training":
    task_key_counts = {0: {0: 366285, 1: 0, 2: 0, 3: 0, 4: 0}, 1: {0: 366285, 1: 0, 2: 0, 3: 0, 4: 0}, 2: {0: 366285, 1: 0, 2: 0, 3: 0, 4: 0}, 3: {0: 366285, 1: 0, 2: 0, 3: 0, 4: 0}, 4: {0: 0, 1: 300000, 2: 0, 3: 13376, 4: 0}, 5: {0: 0, 1: 300000, 2: 0, 3: 13376, 4: 0}, 6: {0: 0, 1: 300000, 2: 0, 3: 13376, 4: 0}, 7: {0: 0, 1: 300000, 2: 0, 3: 13376, 4: 0}, 8: {0: 0, 1: 0, 2: 250000, 3: 0, 4: 0}, 9: {0: 0, 1: 0, 2: 250000, 3: 0, 4: 0}, 10: {0: 0, 1: 0, 2: 250000, 3: 0, 4: 0}, 11: {0: 0, 1: 0, 2: 250000, 3: 0, 4: 0}, 12: {0: 0, 1: 0, 2: 0, 3: 77949, 4: 0}, 13: {0: 0, 1: 0, 2: 0, 3: 77949, 4: 0}, 14: {0: 0, 1: 0, 2: 0, 3: 77949, 4: 0}, 15: {0: 0, 1: 0, 2: 0, 3: 77949, 4: 0}, 16: {0: 0, 1: 0, 2: 0, 3: 0, 4: 300000}, 17: {0: 0, 1: 0, 2: 0, 3: 0, 4: 300000}, 18: {0: 0, 1: 0, 2: 0, 3: 0, 4: 300000}, 19: {0: 0, 1: 0, 2: 0, 3: 0, 4: 300000}}
elif args.model == "5_datasets_task_inc":
    task_key_counts = {0: {0: 26032, 1: 26032, 2: 26032, 3: 26032, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0}, 1: {0: 0, 1: 0, 2: 0, 3: 0, 4: 10000, 5: 10000, 6: 10000, 7: 10000, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0}, 2: {0: 16, 1: 16, 2: 16, 3: 16, 4: 0, 5: 0, 6: 0, 7: 0, 8: 9984, 9: 9984, 10: 9984, 11: 9984, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0}, 3: {0: 0, 1: 0, 2: 0, 3: 0, 4: 176, 5: 176, 6: 176, 7: 176, 8: 0, 9: 0, 10: 0, 11: 0, 12: 283, 13: 283, 14: 283, 15: 283, 16: 0, 17: 0, 18: 0, 19: 0}, 4: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 10000, 17: 10000, 18: 10000, 19: 10000}}
elif args.model == "5_datasets_no_batchwise":
    task_key_counts = {0: {0: 4, 1: 21355, 2: 243, 3: 0, 4: 22059, 5: 3197, 6: 106, 7: 65, 8: 3639, 9: 0, 10: 25749, 11: 165, 12: 3322, 13: 0, 14: 0, 15: 0, 16: 0, 17: 20342, 18: 2, 19: 3880}, 1: {0: 0, 1: 48, 2: 0, 3: 0, 4: 55, 5: 0, 6: 19, 7: 9349, 8: 9961, 9: 0, 10: 605, 11: 0, 12: 9963, 13: 0, 14: 0, 15: 0, 16: 0, 17: 36, 18: 0, 19: 9964}, 2: {0: 83, 1: 3867, 2: 185, 3: 80, 4: 3965, 5: 572, 6: 1968, 7: 3963, 8: 5520, 9: 199, 10: 3603, 11: 390, 12: 5295, 13: 164, 14: 165, 15: 250, 16: 298, 17: 3772, 18: 152, 19: 5509}, 3: {0: 0, 1: 25, 2: 0, 3: 0, 4: 29, 5: 0, 6: 5, 7: 236, 8: 435, 9: 0, 10: 212, 11: 0, 12: 435, 13: 0, 14: 0, 15: 0, 16: 0, 17: 24, 18: 0, 19: 435}, 4: {0: 0, 1: 6591, 2: 0, 3: 0, 4: 6603, 5: 0, 6: 6311, 7: 3153, 8: 3414, 9: 0, 10: 534, 11: 0, 12: 3399, 13: 0, 14: 0, 15: 0, 16: 0, 17: 6594, 18: 0, 19: 3401}}
elif args.model == "5_datasets_no_batchwise_training":
    task_key_counts = {0: {0: 6, 1: 0, 2: 0, 3: 0, 4: 0}, 1: {0: 149635, 1: 0, 2: 93527, 3: 15674, 4: 195669}, 2: {0: 39, 1: 0, 2: 0, 3: 0, 4: 0}, 3: {0: 22, 1: 0, 2: 0, 3: 0, 4: 0}, 4: {0: 148833, 1: 0, 2: 93693, 3: 17543, 4: 195389}, 5: {0: 506, 1: 0, 2: 0, 3: 0, 4: 0}, 6: {0: 216850, 1: 300000, 2: 152314, 3: 10028, 4: 134514}, 7: {0: 149232, 1: 0, 2: 91944, 3: 28, 4: 74207}, 8: {0: 217017, 1: 300000, 2: 156371, 3: 81304, 4: 105180}, 9: {0: 3, 1: 0, 2: 0, 3: 0, 4: 0}, 10: {0: 837, 1: 0, 2: 6061, 3: 73151, 4: 91026}, 11: {0: 82, 1: 0, 2: 0, 3: 0, 4: 0}, 12: {0: 216235, 1: 300000, 2: 156390, 3: 76298, 4: 104380}, 13: {0: 33, 1: 0, 2: 0, 3: 0, 4: 0}, 14: {0: 11, 1: 0, 2: 0, 3: 0, 4: 0}, 15: {0: 23, 1: 0, 2: 0, 3: 0, 4: 0}, 16: {0: 27, 1: 0, 2: 0, 3: 0, 4: 0}, 17: {0: 149065, 1: 0, 2: 92949, 3: 15560, 4: 195336}, 18: {0: 376, 1: 0, 2: 0, 3: 0, 4: 0}, 19: {0: 216308, 1: 300000, 2: 156751, 3: 75714, 4: 104299}}
elif args.model == "l2p_task_inc":
    task_key_counts = {0: {0: 1000, 1: 1000, 2: 1000, 3: 1000, 4: 1000, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 1: {0: 984, 1: 984, 2: 984, 3: 984, 4: 984, 5: 16, 6: 16, 7: 16, 8: 16, 9: 16, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 2: {0: 856, 1: 856, 2: 856, 3: 856, 4: 856, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 144, 11: 144, 12: 144, 13: 144, 14: 144, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 3: {0: 952, 1: 952, 2: 952, 3: 952, 4: 952, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 48, 16: 48, 17: 48, 18: 48, 19: 48, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 4: {0: 984, 1: 984, 2: 984, 3: 984, 4: 984, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 16, 21: 16, 22: 16, 23: 16, 24: 16, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 5: {0: 952, 1: 952, 2: 952, 3: 952, 4: 952, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 48, 26: 48, 27: 48, 28: 48, 29: 48, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 6: {0: 984, 1: 984, 2: 984, 3: 984, 4: 984, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 16, 31: 16, 32: 16, 33: 16, 34: 16, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 7: {0: 936, 1: 936, 2: 936, 3: 936, 4: 936, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 64, 36: 64, 37: 64, 38: 64, 39: 64, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 8: {0: 968, 1: 968, 2: 968, 3: 968, 4: 968, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 32, 41: 32, 42: 32, 43: 32, 44: 32, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 9: {0: 984, 1: 984, 2: 984, 3: 984, 4: 984, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 16, 46: 16, 47: 16, 48: 16, 49: 16}}
elif args.model == "l2p_task_inc_training":
    task_key_counts = {0: {0: 25000, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 1: {0: 25000, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 2: {0: 25000, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 3: {0: 25000, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 4: {0: 25000, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 5: {0: 0, 1: 25000, 2: 7544, 3: 2280, 4: 4088, 5: 896, 6: 1216, 7: 880, 8: 2376, 9: 1536}, 6: {0: 0, 1: 25000, 2: 7544, 3: 2280, 4: 4088, 5: 896, 6: 1216, 7: 880, 8: 2376, 9: 1536}, 7: {0: 0, 1: 25000, 2: 7544, 3: 2280, 4: 4088, 5: 896, 6: 1216, 7: 880, 8: 2376, 9: 1536}, 8: {0: 0, 1: 25000, 2: 7544, 3: 2280, 4: 4088, 5: 896, 6: 1216, 7: 880, 8: 2376, 9: 1536}, 9: {0: 0, 1: 25000, 2: 7544, 3: 2280, 4: 4088, 5: 896, 6: 1216, 7: 880, 8: 2376, 9: 1536}, 10: {0: 0, 1: 0, 2: 17456, 3: 944, 4: 3672, 5: 256, 6: 832, 7: 416, 8: 224, 9: 560}, 11: {0: 0, 1: 0, 2: 17456, 3: 944, 4: 3672, 5: 256, 6: 832, 7: 416, 8: 224, 9: 560}, 12: {0: 0, 1: 0, 2: 17456, 3: 944, 4: 3672, 5: 256, 6: 832, 7: 416, 8: 224, 9: 560}, 13: {0: 0, 1: 0, 2: 17456, 3: 944, 4: 3672, 5: 256, 6: 832, 7: 416, 8: 224, 9: 560}, 14: {0: 0, 1: 0, 2: 17456, 3: 944, 4: 3672, 5: 256, 6: 832, 7: 416, 8: 224, 9: 560}, 15: {0: 0, 1: 0, 2: 0, 3: 21776, 4: 1864, 5: 760, 6: 2392, 7: 280, 8: 160, 9: 2384}, 16: {0: 0, 1: 0, 2: 0, 3: 21776, 4: 1864, 5: 760, 6: 2392, 7: 280, 8: 160, 9: 2384}, 17: {0: 0, 1: 0, 2: 0, 3: 21776, 4: 1864, 5: 760, 6: 2392, 7: 280, 8: 160, 9: 2384}, 18: {0: 0, 1: 0, 2: 0, 3: 21776, 4: 1864, 5: 760, 6: 2392, 7: 280, 8: 160, 9: 2384}, 19: {0: 0, 1: 0, 2: 0, 3: 21776, 4: 1864, 5: 760, 6: 2392, 7: 280, 8: 160, 9: 2384}, 20: {0: 0, 1: 0, 2: 0, 3: 0, 4: 15376, 5: 128, 6: 32, 7: 32, 8: 144, 9: 144}, 21: {0: 0, 1: 0, 2: 0, 3: 0, 4: 15376, 5: 128, 6: 32, 7: 32, 8: 144, 9: 144}, 22: {0: 0, 1: 0, 2: 0, 3: 0, 4: 15376, 5: 128, 6: 32, 7: 32, 8: 144, 9: 144}, 23: {0: 0, 1: 0, 2: 0, 3: 0, 4: 15376, 5: 128, 6: 32, 7: 32, 8: 144, 9: 144}, 24: {0: 0, 1: 0, 2: 0, 3: 0, 4: 15376, 5: 128, 6: 32, 7: 32, 8: 144, 9: 144}, 25: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 22960, 6: 224, 7: 128, 8: 208, 9: 1984}, 26: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 22960, 6: 224, 7: 128, 8: 208, 9: 1984}, 27: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 22960, 6: 224, 7: 128, 8: 208, 9: 1984}, 28: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 22960, 6: 224, 7: 128, 8: 208, 9: 1984}, 29: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 22960, 6: 224, 7: 128, 8: 208, 9: 1984}, 30: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 20304, 7: 752, 8: 16, 9: 304}, 31: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 20304, 7: 752, 8: 16, 9: 304}, 32: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 20304, 7: 752, 8: 16, 9: 304}, 33: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 20304, 7: 752, 8: 16, 9: 304}, 34: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 20304, 7: 752, 8: 16, 9: 304}, 35: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 22512, 8: 16, 9: 5408}, 36: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 22512, 8: 16, 9: 5408}, 37: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 22512, 8: 16, 9: 5408}, 38: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 22512, 8: 16, 9: 5408}, 39: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 22512, 8: 16, 9: 5408}, 40: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 21856, 9: 3704}, 41: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 21856, 9: 3704}, 42: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 21856, 9: 3704}, 43: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 21856, 9: 3704}, 44: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 21856, 9: 3704}, 45: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 8976}, 46: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 8976}, 47: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 8976}, 48: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 8976}, 49: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 8976}}
elif args.model == "l2p_task_inc_only":
    task_key_counts = {0: {0: 1000, 1: 1000, 2: 1000, 3: 1000, 4: 1000, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 1: {0: 1000, 1: 1000, 2: 1000, 3: 1000, 4: 1000, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 2: {0: 1000, 1: 1000, 2: 1000, 3: 1000, 4: 1000, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 3: {0: 1000, 1: 1000, 2: 1000, 3: 1000, 4: 1000, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 4: {0: 1000, 1: 1000, 2: 1000, 3: 1000, 4: 1000, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 5: {0: 1000, 1: 1000, 2: 1000, 3: 1000, 4: 1000, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 6: {0: 1000, 1: 1000, 2: 1000, 3: 1000, 4: 1000, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 7: {0: 1000, 1: 1000, 2: 1000, 3: 1000, 4: 1000, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 8: {0: 1000, 1: 1000, 2: 1000, 3: 1000, 4: 1000, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 9: {0: 1000, 1: 1000, 2: 1000, 3: 1000, 4: 1000, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}}
elif args.model == "l2p_task_inc_only_training":
    task_key_counts = {0: {0: 25000, 1: 25000, 2: 25000, 3: 25000, 4: 25000, 5: 25000, 6: 25000, 7: 25000, 8: 25000, 9: 25000}, 1: {0: 25000, 1: 25000, 2: 25000, 3: 25000, 4: 25000, 5: 25000, 6: 25000, 7: 25000, 8: 25000, 9: 25000}, 2: {0: 25000, 1: 25000, 2: 25000, 3: 25000, 4: 25000, 5: 25000, 6: 25000, 7: 25000, 8: 25000, 9: 25000}, 3: {0: 25000, 1: 25000, 2: 25000, 3: 25000, 4: 25000, 5: 25000, 6: 25000, 7: 25000, 8: 25000, 9: 25000}, 4: {0: 25000, 1: 25000, 2: 25000, 3: 25000, 4: 25000, 5: 25000, 6: 25000, 7: 25000, 8: 25000, 9: 25000}, 5: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 6: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 7: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 8: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 9: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 10: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 11: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 12: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 13: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 14: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 15: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 16: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 17: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 18: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 19: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 20: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 21: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 22: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 23: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 24: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 25: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 26: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 27: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 28: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 29: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 30: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 31: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 32: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 33: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 34: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 35: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 36: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 37: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 38: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 39: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 40: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 41: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 42: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 43: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 44: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 45: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 46: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 47: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 48: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 49: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}}
elif args.model == "l2p_task_inc_only":
    task_key_counts = {0: {0: 1000, 1: 1000, 2: 1000, 3: 1000, 4: 1000, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 1: {0: 1000, 1: 1000, 2: 1000, 3: 1000, 4: 1000, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 2: {0: 1000, 1: 1000, 2: 1000, 3: 1000, 4: 1000, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 3: {0: 1000, 1: 1000, 2: 1000, 3: 1000, 4: 1000, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 4: {0: 1000, 1: 1000, 2: 1000, 3: 1000, 4: 1000, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 5: {0: 1000, 1: 1000, 2: 1000, 3: 1000, 4: 1000, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 6: {0: 1000, 1: 1000, 2: 1000, 3: 1000, 4: 1000, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 7: {0: 1000, 1: 1000, 2: 1000, 3: 1000, 4: 1000, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 8: {0: 1000, 1: 1000, 2: 1000, 3: 1000, 4: 1000, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 9: {0: 1000, 1: 1000, 2: 1000, 3: 1000, 4: 1000, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}}
elif args.model == "l2p_task_inc_only_training":
    task_key_counts = {0: {0: 25000, 1: 25000, 2: 25000, 3: 25000, 4: 25000, 5: 25000, 6: 25000, 7: 25000, 8: 25000, 9: 25000}, 1: {0: 25000, 1: 25000, 2: 25000, 3: 25000, 4: 25000, 5: 25000, 6: 25000, 7: 25000, 8: 25000, 9: 25000}, 2: {0: 25000, 1: 25000, 2: 25000, 3: 25000, 4: 25000, 5: 25000, 6: 25000, 7: 25000, 8: 25000, 9: 25000}, 3: {0: 25000, 1: 25000, 2: 25000, 3: 25000, 4: 25000, 5: 25000, 6: 25000, 7: 25000, 8: 25000, 9: 25000}, 4: {0: 25000, 1: 25000, 2: 25000, 3: 25000, 4: 25000, 5: 25000, 6: 25000, 7: 25000, 8: 25000, 9: 25000}, 5: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 6: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 7: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 8: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 9: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 10: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 11: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 12: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 13: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 14: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 15: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 16: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 17: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 18: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 19: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 20: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 21: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 22: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 23: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 24: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 25: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 26: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 27: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 28: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 29: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 30: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 31: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 32: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 33: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 34: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 35: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 36: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 37: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 38: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 39: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 40: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 41: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 42: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 43: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 44: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 45: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 46: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 47: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 48: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 49: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}}
elif args.model == "l2p_task_init_only":
    task_key_counts = {0: {0: 80, 1: 80, 2: 80, 3: 80, 4: 80, 5: 232, 6: 232, 7: 232, 8: 232, 9: 232, 10: 192, 11: 192, 12: 192, 13: 192, 14: 192, 15: 96, 16: 96, 17: 96, 18: 96, 19: 96, 20: 16, 21: 16, 22: 16, 23: 16, 24: 16, 25: 48, 26: 48, 27: 48, 28: 48, 29: 48, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 160, 36: 160, 37: 160, 38: 160, 39: 160, 40: 160, 41: 160, 42: 160, 43: 160, 44: 160, 45: 16, 46: 16, 47: 16, 48: 16, 49: 16}, 1: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 1000, 6: 1000, 7: 1000, 8: 1000, 9: 1000, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 2: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 1000, 11: 1000, 12: 1000, 13: 1000, 14: 1000, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 3: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 48, 6: 48, 7: 48, 8: 48, 9: 48, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 952, 16: 952, 17: 952, 18: 952, 19: 952, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 4: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 984, 21: 984, 22: 984, 23: 984, 24: 984, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 16, 41: 16, 42: 16, 43: 16, 44: 16, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 5: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 16, 16: 16, 17: 16, 18: 16, 19: 16, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 984, 26: 984, 27: 984, 28: 984, 29: 984, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 6: {0: 16, 1: 16, 2: 16, 3: 16, 4: 16, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 984, 31: 984, 32: 984, 33: 984, 34: 984, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 7: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 1000, 36: 1000, 37: 1000, 38: 1000, 39: 1000, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 8: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 1000, 41: 1000, 42: 1000, 43: 1000, 44: 1000, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 9: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 16, 6: 16, 7: 16, 8: 16, 9: 16, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 16, 16: 16, 17: 16, 18: 16, 19: 16, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 16, 36: 16, 37: 16, 38: 16, 39: 16, 40: 32, 41: 32, 42: 32, 43: 32, 44: 32, 45: 920, 46: 920, 47: 920, 48: 920, 49: 920}}
elif args.model == "l2p_task_init_only_training":
    task_key_counts = {0: {0: 24984, 1: 25000, 2: 25000, 3: 25000, 4: 25000, 5: 25000, 6: 25000, 7: 25000, 8: 25000, 9: 25000}, 1: {0: 24984, 1: 25000, 2: 25000, 3: 25000, 4: 25000, 5: 25000, 6: 25000, 7: 25000, 8: 25000, 9: 25000}, 2: {0: 24984, 1: 25000, 2: 25000, 3: 25000, 4: 25000, 5: 25000, 6: 25000, 7: 25000, 8: 25000, 9: 25000}, 3: {0: 24984, 1: 25000, 2: 25000, 3: 25000, 4: 25000, 5: 25000, 6: 25000, 7: 25000, 8: 25000, 9: 25000}, 4: {0: 24984, 1: 25000, 2: 25000, 3: 25000, 4: 25000, 5: 25000, 6: 25000, 7: 25000, 8: 25000, 9: 25000}, 5: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 6: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 7: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 8: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 9: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 10: {0: 16, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 11: {0: 16, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 12: {0: 16, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 13: {0: 16, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 14: {0: 16, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 15: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 16: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 17: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 18: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 19: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 20: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 21: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 22: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 23: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 24: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 25: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 26: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 27: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 28: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 29: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 30: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 31: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 32: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 33: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 34: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 35: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 36: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 37: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 38: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 39: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 40: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 41: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 42: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 43: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 44: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 45: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 46: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 47: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 48: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}, 49: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}}
elif args.model == "l2p_task_init_frozen":
    task_key_counts = {0: {0: 1000, 1: 1000, 2: 1000, 3: 1000, 4: 1000, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 1: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 984, 6: 984, 7: 984, 8: 984, 9: 984, 10: 16, 11: 16, 12: 16, 13: 16, 14: 16, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 2: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 1000, 11: 1000, 12: 1000, 13: 1000, 14: 1000, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 3: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 32, 6: 32, 7: 32, 8: 32, 9: 32, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 968, 16: 968, 17: 968, 18: 968, 19: 968, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 4: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 16, 11: 16, 12: 16, 13: 16, 14: 16, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 968, 21: 968, 22: 968, 23: 968, 24: 968, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 16, 41: 16, 42: 16, 43: 16, 44: 16, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 5: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 16, 16: 16, 17: 16, 18: 16, 19: 16, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 984, 26: 984, 27: 984, 28: 984, 29: 984, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 6: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 984, 31: 984, 32: 984, 33: 984, 34: 984, 35: 16, 36: 16, 37: 16, 38: 16, 39: 16, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 7: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 1000, 36: 1000, 37: 1000, 38: 1000, 39: 1000, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 8: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 16, 6: 16, 7: 16, 8: 16, 9: 16, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 984, 41: 984, 42: 984, 43: 984, 44: 984, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 9: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 16, 6: 16, 7: 16, 8: 16, 9: 16, 10: 16, 11: 16, 12: 16, 13: 16, 14: 16, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 32, 36: 32, 37: 32, 38: 32, 39: 32, 40: 16, 41: 16, 42: 16, 43: 16, 44: 16, 45: 920, 46: 920, 47: 920, 48: 920, 49: 920}}
elif args.model == "l2p_task_init_frozen_training":
    task_key_counts = {0: {0: 20016, 1: 48, 2: 0, 3: 192, 4: 64, 5: 120, 6: 16, 7: 0, 8: 64, 9: 184}, 1: {0: 20016, 1: 48, 2: 0, 3: 192, 4: 64, 5: 120, 6: 16, 7: 0, 8: 64, 9: 184}, 2: {0: 20016, 1: 48, 2: 0, 3: 192, 4: 64, 5: 120, 6: 16, 7: 0, 8: 64, 9: 184}, 3: {0: 20016, 1: 48, 2: 0, 3: 192, 4: 64, 5: 120, 6: 16, 7: 0, 8: 64, 9: 184}, 4: {0: 20016, 1: 48, 2: 0, 3: 192, 4: 64, 5: 120, 6: 16, 7: 0, 8: 64, 9: 184}, 5: {0: 64, 1: 20776, 2: 0, 3: 4120, 4: 1448, 5: 248, 6: 96, 7: 48, 8: 608, 9: 2392}, 6: {0: 64, 1: 20776, 2: 0, 3: 4120, 4: 1448, 5: 248, 6: 96, 7: 48, 8: 608, 9: 2392}, 7: {0: 64, 1: 20776, 2: 0, 3: 4120, 4: 1448, 5: 248, 6: 96, 7: 48, 8: 608, 9: 2392}, 8: {0: 64, 1: 20776, 2: 0, 3: 4120, 4: 1448, 5: 248, 6: 96, 7: 48, 8: 608, 9: 2392}, 9: {0: 64, 1: 20776, 2: 0, 3: 4120, 4: 1448, 5: 248, 6: 96, 7: 48, 8: 608, 9: 2392}, 10: {0: 4472, 1: 4096, 2: 24936, 3: 8424, 4: 16808, 5: 3184, 6: 5272, 7: 2392, 8: 7800, 9: 12336}, 11: {0: 4472, 1: 4096, 2: 24936, 3: 8424, 4: 16808, 5: 3184, 6: 5272, 7: 2392, 8: 7800, 9: 12336}, 12: {0: 4472, 1: 4096, 2: 24936, 3: 8424, 4: 16808, 5: 3184, 6: 5272, 7: 2392, 8: 7800, 9: 12336}, 13: {0: 4472, 1: 4096, 2: 24936, 3: 8424, 4: 16808, 5: 3184, 6: 5272, 7: 2392, 8: 7800, 9: 12336}, 14: {0: 4472, 1: 4096, 2: 24936, 3: 8424, 4: 16808, 5: 3184, 6: 5272, 7: 2392, 8: 7800, 9: 12336}, 15: {0: 0, 1: 0, 2: 0, 3: 8536, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 16}, 16: {0: 0, 1: 0, 2: 0, 3: 8536, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 16}, 17: {0: 0, 1: 0, 2: 0, 3: 8536, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 16}, 18: {0: 0, 1: 0, 2: 0, 3: 8536, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 16}, 19: {0: 0, 1: 0, 2: 0, 3: 8536, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 16}, 20: {0: 0, 1: 0, 2: 0, 3: 0, 4: 5248, 5: 0, 6: 0, 7: 0, 8: 0, 9: 32}, 21: {0: 0, 1: 0, 2: 0, 3: 0, 4: 5248, 5: 0, 6: 0, 7: 0, 8: 0, 9: 32}, 22: {0: 0, 1: 0, 2: 0, 3: 0, 4: 5248, 5: 0, 6: 0, 7: 0, 8: 0, 9: 32}, 23: {0: 0, 1: 0, 2: 0, 3: 0, 4: 5248, 5: 0, 6: 0, 7: 0, 8: 0, 9: 32}, 24: {0: 0, 1: 0, 2: 0, 3: 0, 4: 5248, 5: 0, 6: 0, 7: 0, 8: 0, 9: 32}, 25: {0: 0, 1: 0, 2: 0, 3: 32, 4: 48, 5: 20144, 6: 0, 7: 0, 8: 0, 9: 176}, 26: {0: 0, 1: 0, 2: 0, 3: 32, 4: 48, 5: 20144, 6: 0, 7: 0, 8: 0, 9: 176}, 27: {0: 0, 1: 0, 2: 0, 3: 32, 4: 48, 5: 20144, 6: 0, 7: 0, 8: 0, 9: 176}, 28: {0: 0, 1: 0, 2: 0, 3: 32, 4: 48, 5: 20144, 6: 0, 7: 0, 8: 0, 9: 176}, 29: {0: 0, 1: 0, 2: 0, 3: 32, 4: 48, 5: 20144, 6: 0, 7: 0, 8: 0, 9: 176}, 30: {0: 64, 1: 16, 2: 0, 3: 1184, 4: 240, 5: 256, 6: 19136, 7: 384, 8: 96, 9: 904}, 31: {0: 64, 1: 16, 2: 0, 3: 1184, 4: 240, 5: 256, 6: 19136, 7: 384, 8: 96, 9: 904}, 32: {0: 64, 1: 16, 2: 0, 3: 1184, 4: 240, 5: 256, 6: 19136, 7: 384, 8: 96, 9: 904}, 33: {0: 64, 1: 16, 2: 0, 3: 1184, 4: 240, 5: 256, 6: 19136, 7: 384, 8: 96, 9: 904}, 34: {0: 64, 1: 16, 2: 0, 3: 1184, 4: 240, 5: 256, 6: 19136, 7: 384, 8: 96, 9: 904}, 35: {0: 384, 1: 64, 2: 64, 3: 2400, 4: 1128, 5: 1000, 6: 480, 7: 22176, 8: 48, 9: 4392}, 36: {0: 384, 1: 64, 2: 64, 3: 2400, 4: 1128, 5: 1000, 6: 480, 7: 22176, 8: 48, 9: 4392}, 37: {0: 384, 1: 64, 2: 64, 3: 2400, 4: 1128, 5: 1000, 6: 480, 7: 22176, 8: 48, 9: 4392}, 38: {0: 384, 1: 64, 2: 64, 3: 2400, 4: 1128, 5: 1000, 6: 480, 7: 22176, 8: 48, 9: 4392}, 39: {0: 384, 1: 64, 2: 64, 3: 2400, 4: 1128, 5: 1000, 6: 480, 7: 22176, 8: 48, 9: 4392}, 40: {0: 0, 1: 0, 2: 0, 3: 96, 4: 16, 5: 48, 6: 0, 7: 0, 8: 16384, 9: 152}, 41: {0: 0, 1: 0, 2: 0, 3: 96, 4: 16, 5: 48, 6: 0, 7: 0, 8: 16384, 9: 152}, 42: {0: 0, 1: 0, 2: 0, 3: 96, 4: 16, 5: 48, 6: 0, 7: 0, 8: 16384, 9: 152}, 43: {0: 0, 1: 0, 2: 0, 3: 96, 4: 16, 5: 48, 6: 0, 7: 0, 8: 16384, 9: 152}, 44: {0: 0, 1: 0, 2: 0, 3: 96, 4: 16, 5: 48, 6: 0, 7: 0, 8: 16384, 9: 152}, 45: {0: 0, 1: 0, 2: 0, 3: 16, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 4416}, 46: {0: 0, 1: 0, 2: 0, 3: 16, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 4416}, 47: {0: 0, 1: 0, 2: 0, 3: 16, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 4416}, 48: {0: 0, 1: 0, 2: 0, 3: 16, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 4416}, 49: {0: 0, 1: 0, 2: 0, 3: 16, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 4416}}
elif args.model == "5_datasets_task_inc_only":
    task_key_counts = {0: {0: 26032, 1: 26032, 2: 26032, 3: 26032, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0}, 1: {0: 10000, 1: 10000, 2: 10000, 3: 10000, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0}, 2: {0: 10000, 1: 10000, 2: 10000, 3: 10000, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0}, 3: {0: 459, 1: 459, 2: 459, 3: 459, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0}, 4: {0: 10000, 1: 10000, 2: 10000, 3: 10000, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0}}
elif args.model == "5_datasets_task_inc_only_training":
    task_key_counts = {0: {0: 366285, 1: 300000, 2: 250000, 3: 91325, 4: 300000}, 1: {0: 366285, 1: 300000, 2: 250000, 3: 91325, 4: 300000}, 2: {0: 366285, 1: 300000, 2: 250000, 3: 91325, 4: 300000}, 3: {0: 366285, 1: 300000, 2: 250000, 3: 91325, 4: 300000}, 4: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 5: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 6: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 7: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 8: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 9: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 10: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 11: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 12: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 13: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 14: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 15: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 16: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 17: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 18: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 19: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}}
elif args.model == "5_datasets_task_init_only":
    task_key_counts = {0: {0: 26032, 1: 26032, 2: 26032, 3: 26032, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0}, 1: {0: 0, 1: 0, 2: 0, 3: 0, 4: 32, 5: 32, 6: 32, 7: 32, 8: 0, 9: 0, 10: 0, 11: 0, 12: 9968, 13: 9968, 14: 9968, 15: 9968, 16: 0, 17: 0, 18: 0, 19: 0}, 2: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 10000, 9: 10000, 10: 10000, 11: 10000, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0}, 3: {0: 0, 1: 0, 2: 0, 3: 0, 4: 64, 5: 64, 6: 64, 7: 64, 8: 0, 9: 0, 10: 0, 11: 0, 12: 395, 13: 395, 14: 395, 15: 395, 16: 0, 17: 0, 18: 0, 19: 0}, 4: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 10000, 17: 10000, 18: 10000, 19: 10000}}
elif args.model == "5_datasets_task_init_only_training":
    task_key_counts = {0: {0: 366285, 1: 0, 2: 0, 3: 0, 4: 0}, 1: {0: 366285, 1: 0, 2: 0, 3: 0, 4: 0}, 2: {0: 366285, 1: 0, 2: 0, 3: 0, 4: 0}, 3: {0: 366285, 1: 0, 2: 0, 3: 0, 4: 0}, 4: {0: 0, 1: 300000, 2: 0, 3: 91325, 4: 0}, 5: {0: 0, 1: 300000, 2: 0, 3: 91325, 4: 0}, 6: {0: 0, 1: 300000, 2: 0, 3: 91325, 4: 0}, 7: {0: 0, 1: 300000, 2: 0, 3: 91325, 4: 0}, 8: {0: 0, 1: 0, 2: 250000, 3: 0, 4: 0}, 9: {0: 0, 1: 0, 2: 250000, 3: 0, 4: 0}, 10: {0: 0, 1: 0, 2: 250000, 3: 0, 4: 0}, 11: {0: 0, 1: 0, 2: 250000, 3: 0, 4: 0}, 12: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 13: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 14: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 15: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 16: {0: 0, 1: 0, 2: 0, 3: 0, 4: 300000}, 17: {0: 0, 1: 0, 2: 0, 3: 0, 4: 300000}, 18: {0: 0, 1: 0, 2: 0, 3: 0, 4: 300000}, 19: {0: 0, 1: 0, 2: 0, 3: 0, 4: 300000}}
elif args.model == "5_datasets_task_init_frozen":
    task_key_counts = {0: {0: 26032, 1: 26032, 2: 26032, 3: 26032, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0}, 1: {0: 0, 1: 0, 2: 0, 3: 0, 4: 10000, 5: 10000, 6: 10000, 7: 10000, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0}, 2: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 10000, 9: 10000, 10: 10000, 11: 10000, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0}, 3: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 459, 13: 459, 14: 459, 15: 459, 16: 0, 17: 0, 18: 0, 19: 0}, 4: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 10000, 17: 10000, 18: 10000, 19: 10000}}
elif args.model == "5_datasets_task_init_frozen_training":
    task_key_counts = {0: {0: 365197, 1: 0, 2: 0, 3: 0, 4: 0}, 1: {0: 365197, 1: 0, 2: 0, 3: 0, 4: 0}, 2: {0: 365197, 1: 0, 2: 0, 3: 0, 4: 0}, 3: {0: 365197, 1: 0, 2: 0, 3: 0, 4: 0}, 4: {0: 0, 1: 300000, 2: 0, 3: 416, 4: 0}, 5: {0: 0, 1: 300000, 2: 0, 3: 416, 4: 0}, 6: {0: 0, 1: 300000, 2: 0, 3: 416, 4: 0}, 7: {0: 0, 1: 300000, 2: 0, 3: 416, 4: 0}, 8: {0: 0, 1: 0, 2: 249984, 3: 0, 4: 0}, 9: {0: 0, 1: 0, 2: 249984, 3: 0, 4: 0}, 10: {0: 0, 1: 0, 2: 249984, 3: 0, 4: 0}, 11: {0: 0, 1: 0, 2: 249984, 3: 0, 4: 0}, 12: {0: 0, 1: 0, 2: 0, 3: 90861, 4: 0}, 13: {0: 0, 1: 0, 2: 0, 3: 90861, 4: 0}, 14: {0: 0, 1: 0, 2: 0, 3: 90861, 4: 0}, 15: {0: 0, 1: 0, 2: 0, 3: 90861, 4: 0}, 16: {0: 1088, 1: 0, 2: 16, 3: 48, 4: 300000}, 17: {0: 1088, 1: 0, 2: 16, 3: 48, 4: 300000}, 18: {0: 1088, 1: 0, 2: 16, 3: 48, 4: 300000}, 19: {0: 1088, 1: 0, 2: 16, 3: 48, 4: 300000}}
elif args.model == "l2p_task_wise_transfer":
    task_key_counts = {0: {0: 984, 1: 984, 2: 960, 3: 984, 4: 960, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 24, 16: 24, 17: 16, 18: 32, 19: 32, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 1: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 800, 6: 784, 7: 784, 8: 800, 9: 784, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 200, 16: 200, 17: 200, 18: 184, 19: 200, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 16, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 16, 41: 16, 42: 16, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 2: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 1000, 11: 1000, 12: 1000, 13: 1000, 14: 1000, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 3: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 1000, 16: 1000, 17: 1000, 18: 1000, 19: 1000, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 4: {0: 16, 1: 16, 2: 16, 3: 16, 4: 16, 5: 16, 6: 16, 7: 16, 8: 16, 9: 16, 10: 16, 11: 16, 12: 16, 13: 16, 14: 16, 15: 304, 16: 304, 17: 304, 18: 304, 19: 304, 20: 608, 21: 608, 22: 608, 23: 608, 24: 608, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 40, 36: 40, 37: 40, 38: 40, 39: 40, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 5: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 64, 16: 64, 17: 64, 18: 64, 19: 64, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 936, 26: 936, 27: 936, 28: 936, 29: 936, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 6: {0: 8, 1: 8, 2: 8, 3: 8, 4: 8, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 384, 16: 384, 17: 368, 18: 352, 19: 368, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 608, 31: 608, 32: 608, 33: 608, 34: 592, 35: 16, 36: 16, 37: 16, 38: 16, 39: 16, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 7: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 1000, 36: 1000, 37: 1000, 38: 1000, 39: 1000, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 8: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 32, 6: 32, 7: 32, 8: 32, 9: 32, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 16, 16: 16, 17: 16, 18: 32, 19: 32, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 952, 41: 952, 42: 952, 43: 936, 44: 936, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 9: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 280, 16: 280, 17: 280, 18: 280, 19: 280, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 16, 26: 16, 27: 32, 28: 32, 29: 32, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 112, 36: 112, 37: 112, 38: 128, 39: 128, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 576, 46: 576, 47: 576, 48: 576, 49: 576}}
elif args.model == "l2p_task_wise":
    task_key_counts = {0: {0: 976, 1: 976, 2: 976, 3: 976, 4: 976, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 24, 16: 24, 17: 24, 18: 24, 19: 24, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 1: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 752, 6: 752, 7: 752, 8: 752, 9: 752, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 248, 16: 248, 17: 248, 18: 248, 19: 248, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 2: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 960, 11: 960, 12: 960, 13: 960, 14: 960, 15: 24, 16: 24, 17: 24, 18: 24, 19: 24, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 16, 36: 16, 37: 16, 38: 16, 39: 16, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 3: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 1000, 16: 1000, 17: 1000, 18: 1000, 19: 1000, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 4: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 16, 6: 16, 7: 16, 8: 16, 9: 16, 10: 64, 11: 64, 12: 64, 13: 64, 14: 64, 15: 352, 16: 352, 17: 352, 18: 352, 19: 368, 20: 464, 21: 464, 22: 448, 23: 464, 24: 464, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 72, 36: 72, 37: 72, 38: 72, 39: 72, 40: 32, 41: 32, 42: 32, 43: 32, 44: 32, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 5: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 16, 6: 16, 7: 16, 8: 16, 9: 16, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 64, 16: 64, 17: 64, 18: 64, 19: 64, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 920, 26: 920, 27: 920, 28: 920, 29: 920, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 6: {0: 8, 1: 8, 2: 8, 3: 8, 4: 8, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 288, 16: 272, 17: 272, 18: 272, 19: 272, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 688, 31: 704, 32: 704, 33: 704, 34: 704, 35: 16, 36: 16, 37: 16, 38: 16, 39: 16, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 7: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 1000, 36: 1000, 37: 1000, 38: 1000, 39: 1000, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 8: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 32, 6: 32, 7: 32, 8: 32, 9: 32, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 80, 16: 80, 17: 80, 18: 80, 19: 64, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 888, 41: 888, 42: 888, 43: 904, 44: 888, 45: 0, 46: 0, 47: 0, 48: 0, 49: 0}, 9: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 352, 16: 352, 17: 336, 18: 336, 19: 336, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 128, 36: 128, 37: 128, 38: 128, 39: 128, 40: 16, 41: 16, 42: 16, 43: 16, 44: 16, 45: 520, 46: 520, 47: 504, 48: 504, 49: 520}}
elif args.model == "random":
    task_key_counts = {0: {0: 2529, 1: 2465, 2: 2531, 3: 2495, 4: 2459, 5: 2434, 6: 2463, 7: 2474, 8: 2476, 9: 2538}, 1: {0: 2484, 1: 2546, 2: 2541, 3: 2547, 4: 2499, 5: 2487, 6: 2496, 7: 2551, 8: 2552, 9: 2561}, 2: {0: 2518, 1: 2651, 2: 2609, 3: 2570, 4: 2645, 5: 2579, 6: 2676, 7: 2579, 8: 2529, 9: 2596}, 3: {0: 2528, 1: 2541, 2: 2490, 3: 2497, 4: 2524, 5: 2599, 6: 2543, 7: 2525, 8: 2545, 9: 2520}, 4: {0: 2502, 1: 2536, 2: 2501, 3: 2466, 4: 2542, 5: 2525, 6: 2479, 7: 2515, 8: 2525, 9: 2481}, 5: {0: 2438, 1: 2398, 2: 2469, 3: 2456, 4: 2419, 5: 2462, 6: 2517, 7: 2440, 8: 2507, 9: 2438}, 6: {0: 2436, 1: 2414, 2: 2414, 3: 2444, 4: 2471, 5: 2489, 6: 2433, 7: 2379, 8: 2484, 9: 2388}, 7: {0: 2518, 1: 2436, 2: 2491, 3: 2522, 4: 2514, 5: 2500, 6: 2441, 7: 2488, 8: 2429, 9: 2509}, 8: {0: 2548, 1: 2541, 2: 2453, 3: 2499, 4: 2458, 5: 2472, 6: 2504, 7: 2574, 8: 2469, 9: 2506}, 9: {0: 2499, 1: 2472, 2: 2501, 3: 2504, 4: 2469, 5: 2453, 6: 2448, 7: 2475, 8: 2484, 9: 2463}}
elif args.model == "training_random":
    task_key_counts = {0: {0: 522, 1: 566, 2: 543, 3: 521, 4: 546, 5: 560, 6: 554, 7: 551, 8: 531, 9: 546}, 1: {0: 481, 1: 473, 2: 490, 3: 508, 4: 495, 5: 491, 6: 469, 7: 506, 8: 482, 9: 485}, 2: {0: 492, 1: 477, 2: 489, 3: 491, 4: 477, 5: 526, 6: 506, 7: 480, 8: 469, 9: 505}, 3: {0: 530, 1: 534, 2: 526, 3: 514, 4: 516, 5: 497, 6: 532, 7: 532, 8: 524, 9: 495}, 4: {0: 554, 1: 525, 2: 505, 3: 533, 4: 496, 5: 509, 6: 505, 7: 534, 8: 536, 9: 519}, 5: {0: 476, 1: 448, 2: 447, 3: 432, 4: 470, 5: 483, 6: 470, 7: 442, 8: 476, 9: 464}, 6: {0: 452, 1: 499, 2: 481, 3: 479, 4: 475, 5: 489, 6: 473, 7: 480, 8: 522, 9: 466}, 7: {0: 508, 1: 491, 2: 512, 3: 539, 4: 508, 5: 497, 6: 497, 7: 524, 8: 491, 9: 521}, 8: {0: 482, 1: 492, 2: 511, 3: 498, 4: 493, 5: 461, 6: 488, 7: 463, 8: 469, 9: 475}, 9: {0: 503, 1: 495, 2: 496, 3: 485, 4: 524, 5: 487, 6: 506, 7: 488, 8: 500, 9: 524}}
elif args.model == "penalization_soft":
    task_key_counts = {0: {0: 0, 1: 26032, 2: 0, 3: 0, 4: 0, 5: 0, 6: 26032, 7: 0, 8: 26032, 9: 0, 10: 0, 11: 0, 12: 26032, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0}, 1: {0: 0, 1: 10000, 2: 0, 3: 0, 4: 0, 5: 0, 6: 10000, 7: 0, 8: 10000, 9: 0, 10: 0, 11: 0, 12: 10000, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0}, 2: {0: 0, 1: 10000, 2: 0, 3: 0, 4: 0, 5: 0, 6: 10000, 7: 0, 8: 10000, 9: 0, 10: 0, 11: 0, 12: 10000, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0}, 3: {0: 0, 1: 459, 2: 0, 3: 0, 4: 0, 5: 0, 6: 459, 7: 0, 8: 459, 9: 0, 10: 0, 11: 0, 12: 459, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0}, 4: {0: 0, 1: 10000, 2: 0, 3: 0, 4: 0, 5: 0, 6: 10000, 7: 0, 8: 10000, 9: 0, 10: 0, 11: 0, 12: 10000, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0}}
elif args.model == "penalization_soft_training":
    task_key_counts = {0: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 1: {0: 366237, 1: 300000, 2: 250000, 3: 91325, 4: 300000}, 2: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 3: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 4: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 5: {0: 32, 1: 0, 2: 0, 3: 0, 4: 0}, 6: {0: 366253, 1: 300000, 2: 250000, 3: 91325, 4: 300000}, 7: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 8: {0: 366269, 1: 300000, 2: 250000, 3: 91325, 4: 300000}, 9: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 10: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 11: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 12: {0: 366205, 1: 300000, 2: 250000, 3: 91325, 4: 300000}, 13: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 14: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 15: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 16: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 17: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 18: {0: 16, 1: 0, 2: 0, 3: 0, 4: 0}, 19: {0: 128, 1: 0, 2: 0, 3: 0, 4: 0}}
elif args.model == "penalization_hard":
    task_key_counts = {0: {0: 0, 1: 26032, 2: 0, 3: 0, 4: 0, 5: 0, 6: 26032, 7: 0, 8: 26032, 9: 0, 10: 0, 11: 0, 12: 26032, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0}, 1: {0: 0, 1: 0, 2: 10000, 3: 10000, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 10000, 12: 0, 13: 0, 14: 0, 15: 10000, 16: 0, 17: 0, 18: 0, 19: 0}, 2: {0: 10000, 1: 16, 2: 0, 3: 0, 4: 0, 5: 0, 6: 16, 7: 0, 8: 16, 9: 9984, 10: 0, 11: 0, 12: 0, 13: 9984, 14: 0, 15: 0, 16: 9984, 17: 0, 18: 0, 19: 0}, 3: {0: 0, 1: 0, 2: 176, 3: 176, 4: 0, 5: 299, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 459, 12: 0, 13: 0, 14: 283, 15: 160, 16: 0, 17: 0, 18: 283, 19: 0}, 4: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 10000, 8: 0, 9: 0, 10: 10000, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 10000, 18: 0, 19: 10000}}
elif args.model == "penalization_hard_training":
    task_key_counts = {0: {0: 0, 1: 0, 2: 249872, 3: 0, 4: 0}, 1: {0: 366237, 1: 0, 2: 0, 3: 0, 4: 0}, 2: {0: 0, 1: 300000, 2: 0, 3: 0, 4: 0}, 3: {0: 0, 1: 299984, 2: 0, 3: 0, 4: 0}, 4: {0: 0, 1: 0, 2: 16, 3: 0, 4: 0}, 5: {0: 32, 1: 0, 2: 32, 3: 91309, 4: 0}, 6: {0: 366253, 1: 0, 2: 0, 3: 0, 4: 0}, 7: {0: 0, 1: 0, 2: 0, 3: 91053, 4: 300000}, 8: {0: 366269, 1: 0, 2: 0, 3: 0, 4: 0}, 9: {0: 0, 1: 0, 2: 249888, 3: 0, 4: 0}, 10: {0: 0, 1: 0, 2: 80, 3: 16, 4: 299968}, 11: {0: 0, 1: 300000, 2: 0, 3: 0, 4: 0}, 12: {0: 366205, 1: 0, 2: 0, 3: 0, 4: 0}, 13: {0: 0, 1: 0, 2: 250000, 3: 0, 4: 0}, 14: {0: 0, 1: 16, 2: 0, 3: 91325, 4: 0}, 15: {0: 0, 1: 300000, 2: 0, 3: 0, 4: 0}, 16: {0: 0, 1: 0, 2: 249936, 3: 0, 4: 0}, 17: {0: 0, 1: 0, 2: 128, 3: 48, 4: 300000}, 18: {0: 16, 1: 0, 2: 0, 3: 91197, 4: 32}, 19: {0: 128, 1: 0, 2: 48, 3: 352, 4: 300000}}
elif args.model == "5_datasets_free_selection_no_batchwise":
    task_key_counts = {0: {0: 25874, 1: 25873, 2: 25874, 3: 25874, 4: 10, 5: 10, 6: 10, 7: 10, 8: 81, 9: 81, 10: 81, 11: 81, 12: 29, 13: 28, 14: 28, 15: 28, 16: 39, 17: 39, 18: 39, 19: 39}, 1: {0: 0, 1: 0, 2: 0, 3: 0, 4: 9987, 5: 9987, 6: 9987, 7: 9987, 8: 0, 9: 0, 10: 0, 11: 0, 12: 13, 13: 13, 14: 13, 15: 13, 16: 0, 17: 0, 18: 0, 19: 0}, 2: {0: 1462, 1: 1462, 2: 1463, 3: 1463, 4: 40, 5: 40, 6: 40, 7: 40, 8: 8388, 9: 8388, 10: 8388, 11: 8387, 12: 40, 13: 40, 14: 39, 15: 40, 16: 70, 17: 70, 18: 70, 19: 70}, 3: {0: 2, 1: 2, 2: 2, 3: 2, 4: 195, 5: 195, 6: 195, 7: 195, 8: 0, 9: 0, 10: 0, 11: 0, 12: 261, 13: 261, 14: 261, 15: 261, 16: 1, 17: 1, 18: 1, 19: 1}, 4: {0: 2, 1: 2, 2: 2, 3: 2, 4: 798, 5: 797, 6: 798, 7: 797, 8: 0, 9: 0, 10: 0, 11: 0, 12: 72, 13: 72, 14: 72, 15: 72, 16: 9129, 17: 9129, 18: 9128, 19: 9128}}
elif args.model == "5_datasets_free_selection_no_batchwise_training":
    task_key_counts = {0: {0: 366285, 1: 0, 2: 0, 3: 0, 4: 0}, 1: {0: 366285, 1: 0, 2: 0, 3: 0, 4: 0}, 2: {0: 366285, 1: 0, 2: 0, 3: 0, 4: 0}, 3: {0: 366285, 1: 0, 2: 0, 3: 0, 4: 0}, 4: {0: 0, 1: 300000, 2: 0, 3: 0, 4: 0}, 5: {0: 0, 1: 300000, 2: 0, 3: 0, 4: 0}, 6: {0: 0, 1: 300000, 2: 0, 3: 0, 4: 0}, 7: {0: 0, 1: 300000, 2: 0, 3: 0, 4: 0}, 8: {0: 0, 1: 0, 2: 250000, 3: 0, 4: 0}, 9: {0: 0, 1: 0, 2: 250000, 3: 0, 4: 0}, 10: {0: 0, 1: 0, 2: 250000, 3: 0, 4: 0}, 11: {0: 0, 1: 0, 2: 250000, 3: 0, 4: 0}, 12: {0: 0, 1: 0, 2: 0, 3: 91325, 4: 0}, 13: {0: 0, 1: 0, 2: 0, 3: 91325, 4: 0}, 14: {0: 0, 1: 0, 2: 0, 3: 91325, 4: 0}, 15: {0: 0, 1: 0, 2: 0, 3: 91325, 4: 0}, 16: {0: 0, 1: 0, 2: 0, 3: 0, 4: 300000}, 17: {0: 0, 1: 0, 2: 0, 3: 0, 4: 300000}, 18: {0: 0, 1: 0, 2: 0, 3: 0, 4: 300000}, 19: {0: 0, 1: 0, 2: 0, 3: 0, 4: 300000}}


if args.model.endswith("_training"):
    num_tasks = len(task_key_counts[0])
    num_keys = len(task_key_counts)
    counts = {t: {c: 0 for c in range(num_keys)} for t in range(num_tasks)}
    for k in range(num_keys):
        for t in range(num_tasks):
            counts[t][k] += task_key_counts[k][t]
    task_key_counts = counts

create_directory(f"plot/{args.model}")
plot_dir = f"plot/{args.model}"

create_directory(f"plot/{args.model}/key_task_counts/")
num_tasks = len(task_key_counts.keys())
num_keys = len(task_key_counts[0])

shape = (num_tasks, num_keys) 
print(shape)

for i in range(num_tasks):
    task_counts = task_key_counts[i]
    classes = task_counts.keys()
    counts = task_counts.values()
    plt.bar(classes, counts)
    plt.xticks(list(classes))
    plt.xlabel("Keys")
    plt.ylabel("Counts")
    if num_keys == 50:
        plt.xticks(range(0, 50, 5))
    # plt.title(f"Task-key counts for task {i}")
    plt.savefig(f'plot/{args.model}/key_task_counts/task_key_counts_task_{i}.png')
    print(f'plot/{args.model}/key_task_counts/task_key_counts_task_{i}.png')
    plt.clf()

task_key_matrix = np.array([np.array([task_key_counts[i][j] for j in range(num_keys)]) for i in range(num_tasks)])

# task_key_matrix = task_key_matrix.T

freq = task_key_matrix.copy()
freq = freq.astype(np.float64)

for i in range(task_key_matrix.shape[0]):
    freq[i] /= freq[i].sum()

# exclude_list = [
#     "task_wise",
#     "5_datasets_l2p",
#     "5_datasets_task_wise",
#     "5_datasets_l2p_training",
#     "5_datasets_task_inc",
#     "5_datasets_task_inc_training",
#     "5_datasets_no_batchwise",
#     "5_datasets_no_batchwise_training",
# ]

# long_thin = [
#     "l2p_task_inc",
#     "l2p_task_inc_training"
# ]

if shape == (10, 10):
    plt.figure(figsize=(20, 20))
    hm = sns.heatmap(data=task_key_matrix, cmap="coolwarm", annot=True, square=True, fmt='g', annot_kws={"size": 20})
    # hm = sns.heatmap(data=freq, cmap="coolwarm", annot=task_key_matrix, square=True, fmt='g', annot_kws={"size": 20})
    cbar = hm.collections[0].colorbar
    cbar.ax.tick_params(labelsize=20)
    plt.xlabel("Tasks", size = 25)
    plt.ylabel("Keys", size = 25)
    plt.xticks(hm.get_xticks(), size= 20)
    plt.yticks(hm.get_yticks(), size= 20)
    # ticks = np.array([x*freq.max()/2 for x in range(3)])
    # ticks[0] += 0.01
    # ticks[-1] -= 0.01
    # cbar.set_ticks(ticks)
    # cbar.set_ticklabels(['Low', 'Middle', 'High'])
elif shape == (10, 50):
    plt.figure(figsize=(120, 25))
    # hm = sns.heatmap(data=freq, annot=task_key_matrix, cmap="coolwarm", square=True, fmt='g', annot_kws={"size": 50})
    hm = sns.heatmap(data=task_key_matrix, annot=False, cmap="coolwarm", square=True, fmt='g', annot_kws={"size": 50}, linewidths=1, cbar_kws = dict(location="top", shrink=0.5))
    cbar = hm.collections[0].colorbar
    cbar.ax.tick_params(labelsize=60)
    plt.xlabel("Keys", size = 80, labelpad=30)
    plt.ylabel("Tasks", size = 80, labelpad=30)
    plt.xticks(hm.get_xticks(), size=60)
    plt.yticks(hm.get_yticks(), size=60, rotation=0)

    # task_key_matrix = task_key_matrix.T
    # freq = freq.T
    # plt.figure(figsize=(75, 75))
    # # hm = sns.heatmap(data=freq, annot=task_key_matrix, cmap="coolwarm", square=True, fmt='g', annot_kws={"size": 50})
    # hm = sns.heatmap(data=task_key_matrix, annot=True, cmap="coolwarm", square=False, fmt='g', annot_kws={"size": 50}, cbar_kws={"shrink": 0.8})
    # cbar = hm.collections[0].colorbar
    # cbar.ax.tick_params(labelsize=60)
    # plt.xlabel("Keys", size = 80, labelpad=30)
    # plt.ylabel("Tasks", size = 80, labelpad=30)
    # plt.xticks(hm.get_xticks(), size=60)
    # plt.yticks(hm.get_yticks(), size=60, rotation=0)
    # # ticks = np.array([x*freq.max()/2 for x in range(3)])
    # # ticks[0] += 0.01
    # # ticks[-1] -= 0.01
    # # cbar.set_ticks(ticks)
    # # cbar.set_ticklabels(['Low', 'Middle', 'High'])
elif shape == (5, 20):
    plt.figure(figsize=(100, 25))
    hm = sns.heatmap(data=freq, annot=task_key_matrix, cmap="coolwarm", square=True, fmt='g', annot_kws={"size": 50}, cbar_kws = dict(location="top", shrink=0.5))
    # hm = sns.heatmap(data=task_key_matrix, annot=True, cmap="coolwarm", square=True, fmt='g', annot_kws={"size": 50})
    cbar = hm.collections[0].colorbar
    cbar.ax.tick_params(labelsize=60)
    plt.xlabel("Keys", size = 80, labelpad=30)
    plt.ylabel("Tasks", size = 80, labelpad=30)
    plt.xticks(hm.get_xticks(), size=60)
    plt.yticks(hm.get_yticks(), size=60)
    ticks = np.array([x*freq.max()/2 for x in range(3)])
    ticks[0] += 0.01
    ticks[-1] -= 0.01
    cbar.set_ticks(ticks)
    cbar.set_ticklabels(['Low', 'Middle', 'High'])
plt.savefig(f'plot/{args.model}/key_task_heatmap.png', bbox_inches='tight')
# plt.savefig(f'plot/{args.model}/key_task_heatmap.png')
plt.clf()

if shape == (10, 50):
    task_key_matrix = task_key_matrix.T
    freq = freq.T
    plt.figure(figsize=(75, 75))
    # hm = sns.heatmap(data=freq, annot=task_key_matrix, cmap="coolwarm", square=True, fmt='g', annot_kws={"size": 50})
    hm = sns.heatmap(data=task_key_matrix, annot=True, cmap="coolwarm", square=False, fmt='g', annot_kws={"size": 50}, cbar_kws={"shrink": 0.8})
    cbar = hm.collections[0].colorbar
    cbar.ax.tick_params(labelsize=60)
    plt.xlabel("Keys", size = 80, labelpad=30)
    plt.ylabel("Tasks", size = 80, labelpad=30)
    plt.xticks(hm.get_xticks(), size=60)
    plt.yticks(hm.get_yticks(), size=60, rotation=0)
    # ticks = np.array([x*freq.max()/2 for x in range(3)])
    # ticks[0] += 0.01
    # ticks[-1] -= 0.01
    # cbar.set_ticks(ticks)
    # cbar.set_ticklabels(['Low', 'Middle', 'High'])
    plt.savefig(f'plot/{args.model}/big_key_task_heatmap.png', bbox_inches='tight')
    plt.clf()
